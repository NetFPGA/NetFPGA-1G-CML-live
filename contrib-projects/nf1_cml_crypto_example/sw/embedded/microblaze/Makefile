# Auto Generated by appguru. Modify at your own risk

CC := mb-gcc
CC_FLAGS := -mlittle-endian -mno-xl-soft-mul -mxl-barrel-shift -mxl-pattern-compare -mcpu=v8.50.b  
CFLAGS := -Wall
LN_FLAGS := -Wl,--start-group,-lxil,-lgcc,-lc,--end-group 

HWSPEC := ../../../hw/SDK/SDK_Export/hw/system.xml
c_SOURCES := $(wildcard *.c)
S_SOURCES := $(wildcard *.S)
s_SOURCES := $(wildcard *.s)
INCLUDES := $(wildcard *.h)
OBJS := $(patsubst %.c, %.o, $(c_SOURCES))
OBJS += $(patsubst %.S, %.o, $(S_SOURCES))
OBJS += $(patsubst %.s, %.o, $(s_SOURCES))
LSCRIPT := -Tlscript.ld

LIBS := microblaze_0/lib/libxil.a
EXEC := executable.elf

INCLUDEPATH := -Imicroblaze_0/include -I.
LIBPATH := -Lmicroblaze_0/lib

default: download

all: $(EXEC)

download: all
	xmd -tcl run.tcl

cscope:
	cscope -Rb

$(EXEC): $(LIBS) $(OBJS) $(INCLUDES)
	$(CC) -o $@ $(OBJS) $(CC_FLAGS) $(CFLAGS) $(LN_FLAGS) $(LIBPATH) $(LSCRIPT)

$(LIBS): system.mss
	libgen -hw $(HWSPEC)  -pe microblaze_0 -od . -log libgen.log system.mss

%.o:%.c
	$(CC) $(CC_FLAGS) $(CFLAGS) -c $< -o $@ $(INCLUDEPATH)

%.o:%.S
	$(CC) $(CC_FLAGS) $(CFLAGS) -c $< -o $@ $(INCLUDEPATH)

%.o:%.s
	$(CC) $(CC_FLAGS) $(CFLAGS) -c $< -o $@ $(INCLUDEPATH)

clean:
	rm -rf $(OBJS) microblaze_0 $(EXEC)
	rm -f libgen.log cscope.out

