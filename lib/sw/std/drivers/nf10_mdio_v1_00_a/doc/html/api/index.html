<html>
<head>
   <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>
   Xilinx Driver emaclite v3_01_a: emaclite v3_01_a
</title>
<link href="../../../../../../../doc/usenglish/css/driver_api_doxygen.css" rel="stylesheet" type="text/css">
</head>
<h3 class="PageHeader">Xilinx Processor IP Library</h3>
<hl>Software Drivers</hl>
<hr class="whs1">

<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li id="current"><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<h1>emaclite v3_01_a</h1>
<p>
The Xilinx Ethernet Lite (EmacLite) driver. This driver supports the Xilinx Ethernet Lite 10/100 MAC (EmacLite).<p>
The Xilinx Ethernet Lite 10/100 MAC supports the following features:<ul>
<li>Media Independent Interface (MII) for connection to external 10/100 Mbps PHY transceivers</li><li>Independent internal transmit and receive buffers</li><li>CSMA/CD compliant operations for half-duplex modes</li><li>Unicast and broadcast</li><li>Automatic FCS insertion</li><li>Automatic pad insertion on transmit</li><li>Configurable ping/pong buffers for either/both transmit and receive buffer areas</li><li>Interrupt driven mode</li><li>Internal loop back</li><li>MDIO Support to access PHY Registers</li></ul>
<p>
The Xilinx Ethernet Lite 10/100 MAC does not support the following features:<ul>
<li>multi-frame buffering only 1 transmit frame is allowed into each transmit buffer, only 1 receive frame is allowed into each receive buffer. the hardware blocks reception until buffer is emptied</li><li>Pause frame (flow control) detection in full-duplex mode</li><li>Programmable inter frame gap</li><li>Multicast and promiscuous address filtering</li><li>Automatic source address insertion or overwrite</li></ul>
<p>
<b>Driver Description</b><p>
The device driver enables higher layer software (e.g., an application) to communicate to the EmacLite. The driver handles transmission and reception of Ethernet frames, as well as configuration of the controller. It does not handle protocol stack functionality such as Link Layer Control (LLC) or the Address Resolution Protocol (ARP). The protocol stack that makes use of the driver handles this functionality. This implies that the driver is simply a pass-through mechanism between a protocol stack and the EmacLite.<p>
Since the driver is a simple pass-through mechanism between a protocol stack and the EmacLite, no assembly or disassembly of Ethernet frames is done at the driver-level. This assumes that the protocol stack passes a correctly formatted Ethernet frame to the driver for transmission, and that the driver does not validate the contents of an incoming frame. A single device driver can support multiple EmacLite devices.<p>
The driver supports interrupt driven mode and the default mode of operation is polled mode. If interrupts are desired, XEmacLite_InterruptEnable() must be called.<p>
<b>Device Configuration</b><p>
The device can be configured in various ways during the FPGA implementation process. Configuration parameters are stored in the <a class="el" href="xemaclite__g_8c.html">xemaclite_g.c</a> file. A table is defined where each entry contains configuration information for an EmacLite device. This information includes such things as the base address of the memory-mapped device and the number of buffers.<p>
<b>Interrupt Processing</b><p>
After _Initialize is called, _InterruptEnable can be called to enable the interrupt driven functionality. If polled operation is desired, just call _Send and check the return code. If XST_FAILURE is returned, call _Send with the same data until XST_SUCCESS is returned. The same idea applies to _Recv. Call _Recv until the returned length is non-zero at which point the received data is in the buffer provided in the function call.<p>
The Transmit and Receive interrupts are enabled within the _InterruptEnable function and disabled in the _InterruptDisable function. The _Send and _Recv functions acknowledge the EmacLite generated interrupts associated with each function. It is the application's responsibility to acknowledge any associated Interrupt Controller interrupts if it is used in the system.<p>
<b>Memory Buffer Alignment</b><p>
The alignment of the input/output buffers for the _Send and _Recv routine is not required to be 32 bits. If the buffer is not aligned on a 32-bit boundary there will be a performance impact while the driver aligns the data for transmission or upon reception.<p>
For optimum performance, the user should provide a 32-bit aligned buffer to the _Send and _Recv routines.<p>
<b>Asserts</b><p>
Asserts are used within all Xilinx drivers to enforce constraints on argument values. Asserts can be turned off on a system-wide basis by defining, at compile time, the NDEBUG identifier. By default, asserts are turned on and it is recommended that application developers leave asserts on during development.<p>
<dl compact><dt><b>Note:</b></dt><dd></dd></dl>
This driver requires EmacLite hardware version 1.01a and higher. It is not compatible with earlier versions of the EmacLite hardware. Use version 1.00a software driver for hardware version 1.00a/b.<p>
The RX hardware is enabled from powerup and there is no disable. It is possible that frames have been received prior to the initialization of the driver. If this situation is possible, call <a class="el" href="xemaclite_8c.html#afee8a352a0dffef7dd5abc36dbd234c">XEmacLite_FlushReceive()</a> to empty the receive buffers after initialization.<p>
This driver is intended to be RTOS and processor independent. It works with physical addresses only. Any needs for dynamic memory management, threads or thread mutual exclusion, virtual memory, or cache control must be satisfied by the layer above this driver.<p>
<pre>
 MODIFICATION HISTORY:</pre><p>
<pre> Ver   Who  Date     Changes
 ----- ---- -------- -----------------------------------------------
 1.01a ecm  01/30/04 First release
 1.11a mta  03/21/07 Updated to new coding style
 1.12a mta  11/28/07 Added the function XEmacLite_CfgInitialize,
		      moved the functions XEmacLite_LookupConfig and
		      XEmacLite_Initialize to <a class="el" href="xemaclite__sinit_8c.html">xemaclite_sinit.c</a> for removing
		      the dependency on the static config table and
		      xparameters.h from the driver initialization
 1.13a sv   02/1/08  Updated the TxBufferAvailable routine to return
		      busy status properly and added macros for Tx/Rx status
 1.14a sdm  08/22/08 Removed support for static interrupt handlers from the MDD
		      file
 2.00a ktn  02/16/09 Added support for MDIO and internal loop back
 2.01a ktn  07/20/09 Updated the XEmacLite_AlignedWrite and
                     XEmacLite_AlignedRead functions to use volatile
                     variables so that they are not optimized.
                     Modified the XEmacLite_EnableInterrupts and
                     XEmacLite_DisableInterrupts functions to enable/disable
                     the interrupt in the Ping buffer as this is used to enable
                     the interrupts for both Ping and Pong Buffers.
                     The interrupt enable bit in the Pong buffer is not used by
                     the HW.
                     Modified XEmacLite_Send function to use Ping buffers
                     Interrupt enable bit since this alone is used to enable
                     the interrupts for both Ping and Pong Buffers.
 3.00a ktn  10/22/09 Updated driver to use the HAL Processor APIs/macros.
		      The macros have been renamed to remove _m from the name in
		      all the driver files.
		      The macros changed in this file are
		      XEmacLite_mNextTransmitAddr is XEmacLite_NextTransmitAddr,
		      XEmacLite_mNextReceiveAddr is XEmacLite_NextReceiveAddr,
		      XEmacLite_mIsMdioConfigured is XEmacLite_IsMdioConfigured,
		      XEmacLite_mIsLoopbackConfigured is
		      XEmacLite_IsLoopbackConfigured.
		      See <a class="el" href="xemaclite__i_8h.html">xemaclite_i.h</a> for the macros which have changed.
 3.01a ktn  07/08/10 The macro XEmacLite_GetReceiveDataLength in the
		      <a class="el" href="xemaclite_8c.html">xemaclite.c</a> file is changed to a static function.
		      XEmacLite_GetReceiveDataLength and XEmacLite_Recv
		      functions  are updated to support little endian
		      MicroBlaze.
 </pre> <p class="Copyright">
Copyright &copy; 1995-2011 Xilinx, Inc. All rights reserved.
</p>
</body>
</html>

